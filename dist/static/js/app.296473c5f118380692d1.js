webpackJsonp([0],{"23wR":function(t,e){},AQny:function(t,e){t.exports={message:{Chinese:"中文",English:"English",login:"CHAT ON",logout:"Logout",miliao:"Secret Chat",miliaoPhrase:"Top security anonymous chat software based on block chain",loginInputTip:"Please enter your SMS password statement for login",registerText:"No account?Create a new anonymous account",safety:"Safety",copy:"copy",copyaddress:"copy",copySuccess:"Copy success",Connectionclosed:"Connection closed",login1:"enter your key",login2:"Please enter",login3:"Forget your key",login4:"Tip",login5:"Will it not be able to decrypt the previous information before it is regenerated?",login6:"Login environment exception",login7:"The secret key you entered cannot be empty",login8:"Please make sure the key is correct, otherwise it will cause the sending to fail!",my:"My",chat:"Chats",set:"Settings",wdye:"Balance",wallet1:"Send the address to someone else and someone can send the appropriate information to your address via a private chat",wallet2:"pieces",wallet3:"Details of the membership fee:Notes: The sac you top up is charged by two sections -- the public network of the Ethereum on the one hand, and our platform on the other to maintain the operation.",wallet4:"Spike",wallet5:"Purchase Succeeds",register1:"Your secret key has been generated",register2:"important note",register3:"This key will be used to encrypt and decrypt your chat information. Be sure to save your secret key.If lost, no way to recover it.Please do not disclose to third parties, otherwise your information may be leaked, we are not responsible!",register6:"Saved Go Chat",chatlist1:"Start New Chat",chatlist2:"Recipient address",chatlist3:"Enter",chatlist4:"cancel",chatlist5:"Please enter",chatlist6:"The address cannot be empty",chatlist7:"You can't send it to yourself",chatlist8:"nothing",chatin1:"Anonymous User",chatin2:"Type your message",chatin3:"The send content cannot be empty",chatin4:"The character length exceeds the limit",chatin5:"sending failure",dlzhbnwk:"The login account cannot be empty",tip01:"The browser does not support automatic replication",set1:"After 5 minutes, the application will exits automatically, and the next login must enter the key.",set2:"Language",specification1:"ALL content you sent are encrypted using TOP Encryption algorithm and saved on Blockchain, which shall NEVER store on any other platform.",specification2:"You privacy message will be kept so far, by keeping you private key secrecy. Even though one use the newest supercomputer, he cannot decipher your message.",specification3:"You can inquire the calling record of your chat in Blockchain Browser. ",welcome:"Welcome"}}},Aa6l:function(t,e){},E51W:function(t,e){},EW9h:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view"),t._v(" "),s("mu-popup",{attrs:{position:"top",popupClass:"popup-top",overlay:!1,open:t.$store.state.isShowTopPopup}},[t._v(t._s(t.$store.state.tipText))]),t._v(" "),s("mu-popup",{attrs:{position:"top",popupClass:"popup-top-success",overlay:!1,open:t.$store.state.isShowSuccess}},[t._v(t._s(t.$store.state.tipText))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.loading,expression:"$store.state.loading"}],staticClass:"loading-shade"},[t._m(0)]),t._v(" "),s("mu-dialog",{attrs:{open:t.$store.state.isShowAlert,title:t.$t("message.login4")}},[t._v("\n    "+t._s(t.$store.state.alertText)+"\n    "),s("mu-flat-button",{attrs:{slot:"actions",label:t.$t("message.chatlist3"),primary:""},nativeOn:{click:function(e){t.$store.state.isShowAlert=!1}},slot:"actions"})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loading-box"},[e("embed",{attrs:{src:"static/svg/loading.svg",type:"image/svg+xml",pluginspage:"http://www.adobe.com/svg/viewer/install/"}})])}]};var o=s("VU/8")({name:"App"},i,!1,function(t){s("gwW5")},null,null).exports,n=s("/ocq"),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"index-page"},[s("router-view",{staticClass:"index-tab-view"}),t._v(" "),s("footer",{staticClass:"footer-bar"},[s("mu-tabs",{attrs:{value:t.activeTab,lineClass:"activeline"},on:{change:t.handleTabChange}},[s("mu-tab",{attrs:{value:"wallet",href:"javascript:;",title:t.$t("message.my")},nativeOn:{click:function(e){t.switchTo("wallet")}}},[s("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),s("mu-tab",{attrs:{value:"chatlist",href:"javascript:;",title:t.$t("message.chat")},nativeOn:{click:function(e){t.switchTo("chatlist")}}},[s("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),s("mu-tab",{attrs:{value:"setting",href:"javascript:;",title:t.$t("message.set")},nativeOn:{click:function(e){t.switchTo("setting")}}},[s("i",{staticClass:"iconfont"},[t._v("")])])],1)],1)],1)},staticRenderFns:[]};var c=s("VU/8")({data:function(){return{activeTab:this.$route.name}},mounted:function(){},methods:{handleTabChange:function(t){this.activeTab=t},loginOut:function(){this.$router.replace("login")},switchTo:function(t){this.$router.replace(t)}},watch:{$route:function(t,e){this.activeTab="addchat"==t.name?"chatlist":t.name}}},r,!1,function(t){s("23wR")},null,null).exports,l=s("TQvf"),u=s.n(l),m={data:function(){return{userid:localStorage.getItem("userid")||"",toast:!1,toastMessage:"",pageData:null,timestamp:""}},mounted:function(){this.getData(),this.$store.state.langValue=localStorage.getItem("LANGUAGE")||"zh-CN",this.$i18n.locale=localStorage.getItem("LANGUAGE")||"zh-CN"},methods:{copy:function(){var t=this,e=new u.a(".tag-read");e.on("success",function(s){t.$store.commit("showTopSuccess",t.$t("message.copySuccess")),e.destroy()}),e.on("error",function(s){t.$store.commit("showTopPopup",t.$t("message.tip01")),e.destroy()})},getData:function(){var t=this;this.timestamp=(new Date).getTime(),this.$store.commit("WSsend",{data:{method:"getTariffPackages",params:[this.userid,this.timestamp]},callback:function(e){if(200==e.code&&"getTariffPackages"==e.method){if(e.serial!=t.timestamp)return;t.pageData=e}}})},buy:function(t){var e=this;this.$store.state.loading=!0,this.timestamp=(new Date).getTime(),this.$store.commit("WSsend",{data:{method:"buyTariffPackages",params:[this.userid,t,this.$store.state.langValue,this.timestamp]},callback:function(t){if(200==t.code&&"buyTariffPackages"==t.method){if(t.serial!=e.timestamp)return;if(1===t.pack_id)e.$store.commit("showAlert",e.$t("message.wallet5")),e.getData();else{if(!t.result.payUrl)return;localStorage.setItem("LANGUAGE",e.$store.state.langValue),window.location.href=t.result.payUrl+"?langId="+e.$store.state.langValue+"&pagebackurl="+window.location.href}}}})}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wallet-page"},[s("header",[t._v(t._s(t.$t("message.my")))]),t._v(" "),s("div",{staticClass:"main"},[s("div",{staticClass:"menu-wrap"},[s("div",{staticClass:"menu"},[s("img",{staticClass:"icon",attrs:{src:"static/images/qrcode_icon.png"}}),t._v(" "),s("div",{staticClass:"content"},[s("p",[t._v(t._s(t.userid))])]),t._v(" "),s("a",{staticClass:"tag-read",attrs:{href:"javascript:;","data-clipboard-text":t.userid},on:{click:t.copy}},[t._v(t._s(t.$t("message.copyaddress")))])]),t._v(" "),s("p",{staticClass:"tip"},[t._v(t._s(t.$t("message.wallet1")))]),t._v(" "),t.pageData?s("div",{staticClass:"menu bt"},[s("img",{staticClass:"icon",attrs:{src:"static/images/wallet_icon.png"}}),t._v(" "),s("div",{staticClass:"content"},[s("label",[t._v(t._s(t.$t("message.wdye")))])]),t._v(" "),s("div",{staticClass:"balance"},[s("span",[t._v(t._s(t.pageData.balance))]),t._v(t._s(t.$t("message.wallet2")))])]):t._e()]),t._v(" "),t.pageData?s("ul",{staticClass:"combo-list"},t._l(t.pageData.result,function(e){return s("li",[s("div",{staticClass:"ctn-l"},[s("label",[t._v(t._s("zh-CN"==t.$store.state.langValue?e.cn_title:e.en_title)+" \n                        "),5==e.pack_id&&"zh-CN"==t.$store.state.langValue?s("img",{attrs:{src:"static/images/chaozhi_icon.png"}}):t._e(),t._v(" "),5==e.pack_id&&"en-US"==t.$store.state.langValue?s("img",{attrs:{src:"static/images/chaozhi_en_icon.png"}}):t._e()]),t._v(" "),s("div",{staticClass:"content"},[t._v(t._s("zh-CN"==t.$store.state.langValue?e.cn_memo:e.en_memo))])]),t._v(" "),0==e.amount?s("mu-raised-button",{attrs:{label:t.$t("message.wallet4"),primary:""},nativeOn:{click:function(s){t.buy(e.pack_id)}}}):t._e(),t._v(" "),0!=e.amount?s("mu-raised-button",{attrs:{label:e.amount+"SAC",primary:""},nativeOn:{click:function(s){t.buy(e.pack_id)}}}):t._e()],1)})):t._e(),t._v(" "),s("div",{staticClass:"flex-wrap"},[s("p",{staticClass:"tip no-border"},[t._v(t._s(t.$t("message.wallet3")))])]),t._v(" "),t.toast?s("mu-toast",{staticClass:"tipbox",attrs:{message:t.toastMessage}}):t._e()],1)])},staticRenderFns:[]};var d=s("VU/8")(m,h,!1,function(t){s("x2y+")},null,null).exports,g={data:function(){return{isShowAlert:!1,to_user_id:""}},methods:{addChat:function(t){this.$store.commit("addChatUser",{userid:this.to_user_id,list:[],pk:t}),this.$router.push({path:"chatin",query:{id:this.to_user_id}})},getUserInfo:function(){var t=this;""!=this.to_user_id.trim()?this.to_user_id!=localStorage.getItem("userid")?(this.$store.state.loading=!0,this.timestamp=(new Date).getTime(),this.$store.commit("WSsend",{data:{method:"getUserInfo",params:[this.to_user_id,this.timestamp]},callback:function(e){if(console.log(1111),e.serial&&200===e.code&&"getUserInfo"==e.method){if(e.serial!=t.timestamp)return;t.addChat(e.result[0].pub_key)}}})):this.$store.commit("showTopPopup",this.$t("message.chatlist7")):this.$store.commit("showTopPopup",this.$t("message.chatlist6"))}},computed:{chatListData:function(){return this.$store.state.chatUserList},changeM:function(){return this.$store.state.changeM}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-list-page"},[s("header",[t._v(t._s(t.$t("message.chat")))]),t._v(" "),s("div",{staticClass:"main"},[s("div",{staticClass:"add-chat",on:{click:function(e){t.isShowAlert=!0}}},[s("img",{staticClass:"icon",attrs:{src:"static/images/add_icon.png"}}),t._v(" "),s("div",{staticClass:"content"},[t._v(t._s(t.$t("message.chatlist1")))]),t._v(" "),s("div",{staticStyle:{display:"none"}},[t._v(t._s(t.changeM))])]),t._v(" "),s("ul",t._l(t.chatListData,function(e,a){return s("li",{key:a,on:{click:function(s){t.$router.push({path:"chatin",query:{id:e.userid}})}}},[s("img",{staticClass:"icon",attrs:{src:"static/images/chat_icon.png"}}),t._v(" "),s("div",{staticClass:"content"},[s("div",[s("h3",[t._v(t._s(e.userid))]),t._v(" "),e.list.length>0?s("span",[t._v(t._s(e.list[e.list.length-1].time))]):t._e()]),t._v(" "),e.list.length>0?s("p",{staticStyle:{"-webkit-box-orient":"vertical"}},[t._v(t._s(e.list[e.list.length-1].message))]):t._e(),t._v(" "),e.list.length<=0?s("p",{staticStyle:{"-webkit-box-orient":"vertical"}},[t._v(t._s(t.$t("message.chatlist8")))]):t._e()])])})),t._v(" "),s("mu-dialog",{attrs:{open:t.isShowAlert,title:t.$t("message.chatlist2")}},[s("mu-text-field",{staticStyle:{width:"100%"},attrs:{hintText:t.$t("message.chatlist5")},model:{value:t.to_user_id,callback:function(e){t.to_user_id=e},expression:"to_user_id"}}),t._v(" "),s("mu-flat-button",{attrs:{slot:"actions",primary:"",label:t.$t("message.chatlist4")},on:{click:function(e){t.isShowAlert=!1}},slot:"actions"}),t._v(" "),s("mu-flat-button",{attrs:{slot:"actions",primary:"",label:t.$t("message.chatlist3")},on:{click:t.getUserInfo},slot:"actions"})],1)],1)])},staticRenderFns:[]};var f=s("VU/8")(g,p,!1,function(t){s("EW9h")},null,null).exports,v={data:function(){return{}},methods:{logout:function(){var t=localStorage.getItem("userid");this.$store.commit("WSsend",{data:{method:"logout",params:[t]}})},handleChange:function(t){this.$store.state.langValue=t,this.$i18n.locale=t,localStorage.setItem("LANGUAGE",t)}},computed:{storeMinute5logout:function(){return this.$store.state.minute5logout}},watch:{storeMinute5logout:function(t,e){var s=this;t&&(this.$store.state.timer=setTimeout(function(){s.$store.state.minute5logout=!1;var t=localStorage.getItem("userid");s.$store.commit("WSsend",{data:{method:"logout",params:[t]}})},3e5))}}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"set-page"},[s("header",[t._v(t._s(t.$t("message.set")))]),t._v(" "),s("div",{staticClass:"main"},[s("ul",[s("li",[s("h3",[t._v(t._s(t.$t("message.safety")))]),t._v(" "),s("div",{staticClass:"content"},[s("mu-checkbox",{staticClass:"demo-checkbox",model:{value:t.$store.state.minute5logout,callback:function(e){t.$set(t.$store.state,"minute5logout",e)},expression:"$store.state.minute5logout"}}),t._v(" "),s("p",{staticClass:"flex1"},[t._v(t._s(t.$t("message.set1")))])],1)]),t._v(" "),s("li",[s("h3",[t._v(t._s(t.$t("message.set2")))]),t._v(" "),s("div",{staticClass:"content"},[s("mu-dropDown-menu",{staticClass:"flex1",attrs:{value:t.$store.state.langValue},on:{change:t.handleChange}},[s("mu-menu-item",{attrs:{value:"zh-CN",title:t.$t("message.Chinese")}}),t._v(" "),s("mu-menu-item",{attrs:{value:"en-US",title:t.$t("message.English")}})],1)],1)])]),t._v(" "),s("mu-raised-button",{staticClass:"logout-btn",attrs:{label:t.$t("message.logout"),fullWidth:"",primary:""},nativeOn:{click:function(e){return t.logout(e)}}}),t._v(" "),s("p",{staticClass:"other-test-info"},[t._v("\n            "+t._s(t.$t("message.specification1"))),s("br"),s("br"),t._v("\n            "+t._s(t.$t("message.specification2"))),s("br"),s("br"),t._v("    \n            "+t._s(t.$t("message.specification3"))),s("br"),s("br")])],1)])},staticRenderFns:[]};var y=s("VU/8")(v,_,!1,function(t){s("Aa6l")},null,null).exports,w={data:function(){return{message:"",to_user_id:"",topPopup:!1,tipText:"",keyPair1:"",keyPair2:"",nonce:"",timestamp:""}},mounted:function(){},methods:{getUserInfo:function(){var t=this;""!=this.to_user_id.trim()?this.to_user_id!=sessionStorage.getItem("userid")?""!=this.message.trim()?(this.$store.state.loading=!0,this.timestamp=(new Date).getTime(),this.$store.commit("WSsend",{data:{method:"getUserInfo",params:[this.to_user_id,this.timestamp]},callback:function(e){if(e.serial&&200===e.code&&"getUserInfo"==e.method){if(e.serial!=t.timestamp)return;t.timestamp=(new Date).getTime(),t.send(e.result[0].pub_key)}}})):this.$store.commit("showTopPopup","发送内容不能为空"):this.$store.commit("showTopPopup","无法向自己发送"):this.$store.commit("showTopPopup","对方地址不能为空")},send:function(t){var e=this,s=nacl.randomBytes(nacl.secretbox.nonceLength),a=nacl.util.encodeBase64(s),i=localStorage.getItem("sec_key"),o=nacl.box(nacl.util.decodeUTF8(this.message),s,nacl.util.decodeBase64(t),nacl.util.decodeBase64(i)),n=sessionStorage.getItem("userid");this.$store.commit("WSsend",{data:{method:"postMessage",params:[n,this.to_user_id,1,nacl.util.encodeBase64(o),a,this.timestamp]},callback:function(s){if(200===s.code&&"postMessage"==s.method){if(!s.serial)return;if(s.serial!=e.timestamp)return;e.timestamp=(new Date).getTime(),e.$store.commit("addChatUser",{userid:e.to_user_id,list:[{message:e.message,self:!0}],pk:t}),e.$router.replace({path:"chatin",query:{id:e.to_user_id}})}}})}}},$={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add-chat-page"},[s("div",{staticClass:"main"},[s("mu-text-field",{attrs:{label:"对方地址",labelFloat:""},model:{value:t.to_user_id,callback:function(e){t.to_user_id=e},expression:"to_user_id"}}),t._v(" "),s("mu-text-field",{attrs:{hintText:"输入您的信息",multiLine:"",rows:1,rowsMax:10},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),t._v(" "),s("mu-raised-button",{attrs:{label:"发送",primary:"",fullWidth:""},nativeOn:{click:function(e){return t.getUserInfo(e)}}}),t._v(" "),s("mu-popup",{attrs:{position:"top",popupClass:"popup-top",overlay:!1,open:t.topPopup}},[t._v(t._s(t.tipText))])],1)])},staticRenderFns:[]};var b=s("VU/8")(w,$,!1,function(t){s("hCDX")},"data-v-bc86971c",null).exports,S=0,C=8;function k(t){return N(T(L(t),t.length*C))}function T(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var s=1732584193,a=-271733879,i=-1732584194,o=271733878,n=0;n<t.length;n+=16){var r=s,c=a,l=i,u=o;a=P(a=P(a=P(a=P(a=U(a=U(a=U(a=U(a=A(a=A(a=A(a=A(a=I(a=I(a=I(a=I(a,i=I(i,o=I(o,s=I(s,a,i,o,t[n+0],7,-680876936),a,i,t[n+1],12,-389564586),s,a,t[n+2],17,606105819),o,s,t[n+3],22,-1044525330),i=I(i,o=I(o,s=I(s,a,i,o,t[n+4],7,-176418897),a,i,t[n+5],12,1200080426),s,a,t[n+6],17,-1473231341),o,s,t[n+7],22,-45705983),i=I(i,o=I(o,s=I(s,a,i,o,t[n+8],7,1770035416),a,i,t[n+9],12,-1958414417),s,a,t[n+10],17,-42063),o,s,t[n+11],22,-1990404162),i=I(i,o=I(o,s=I(s,a,i,o,t[n+12],7,1804603682),a,i,t[n+13],12,-40341101),s,a,t[n+14],17,-1502002290),o,s,t[n+15],22,1236535329),i=A(i,o=A(o,s=A(s,a,i,o,t[n+1],5,-165796510),a,i,t[n+6],9,-1069501632),s,a,t[n+11],14,643717713),o,s,t[n+0],20,-373897302),i=A(i,o=A(o,s=A(s,a,i,o,t[n+5],5,-701558691),a,i,t[n+10],9,38016083),s,a,t[n+15],14,-660478335),o,s,t[n+4],20,-405537848),i=A(i,o=A(o,s=A(s,a,i,o,t[n+9],5,568446438),a,i,t[n+14],9,-1019803690),s,a,t[n+3],14,-187363961),o,s,t[n+8],20,1163531501),i=A(i,o=A(o,s=A(s,a,i,o,t[n+13],5,-1444681467),a,i,t[n+2],9,-51403784),s,a,t[n+7],14,1735328473),o,s,t[n+12],20,-1926607734),i=U(i,o=U(o,s=U(s,a,i,o,t[n+5],4,-378558),a,i,t[n+8],11,-2022574463),s,a,t[n+11],16,1839030562),o,s,t[n+14],23,-35309556),i=U(i,o=U(o,s=U(s,a,i,o,t[n+1],4,-1530992060),a,i,t[n+4],11,1272893353),s,a,t[n+7],16,-155497632),o,s,t[n+10],23,-1094730640),i=U(i,o=U(o,s=U(s,a,i,o,t[n+13],4,681279174),a,i,t[n+0],11,-358537222),s,a,t[n+3],16,-722521979),o,s,t[n+6],23,76029189),i=U(i,o=U(o,s=U(s,a,i,o,t[n+9],4,-640364487),a,i,t[n+12],11,-421815835),s,a,t[n+15],16,530742520),o,s,t[n+2],23,-995338651),i=P(i,o=P(o,s=P(s,a,i,o,t[n+0],6,-198630844),a,i,t[n+7],10,1126891415),s,a,t[n+14],15,-1416354905),o,s,t[n+5],21,-57434055),i=P(i,o=P(o,s=P(s,a,i,o,t[n+12],6,1700485571),a,i,t[n+3],10,-1894986606),s,a,t[n+10],15,-1051523),o,s,t[n+1],21,-2054922799),i=P(i,o=P(o,s=P(s,a,i,o,t[n+8],6,1873313359),a,i,t[n+15],10,-30611744),s,a,t[n+6],15,-1560198380),o,s,t[n+13],21,1309151649),i=P(i,o=P(o,s=P(s,a,i,o,t[n+4],6,-145523070),a,i,t[n+11],10,-1120210379),s,a,t[n+2],15,718787259),o,s,t[n+9],21,-343485551),s=E(s,r),a=E(a,c),i=E(i,l),o=E(o,u)}return Array(s,a,i,o)}function x(t,e,s,a,i,o){return E((n=E(E(e,t),E(a,o)))<<(r=i)|n>>>32-r,s);var n,r}function I(t,e,s,a,i,o,n){return x(e&s|~e&a,t,e,i,o,n)}function A(t,e,s,a,i,o,n){return x(e&a|s&~a,t,e,i,o,n)}function U(t,e,s,a,i,o,n){return x(e^s^a,t,e,i,o,n)}function P(t,e,s,a,i,o,n){return x(s^(e|~a),t,e,i,o,n)}function E(t,e){var s=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(s>>16)<<16|65535&s}function L(t){for(var e=Array(),s=(1<<C)-1,a=0;a<t.length*C;a+=C)e[a>>5]|=(t.charCodeAt(a/C)&s)<<a%32;return e}function N(t){for(var e=S?"0123456789ABCDEF":"0123456789abcdef",s="",a=0;a<4*t.length;a++)s+=e.charAt(t[a>>2]>>a%4*8+4&15)+e.charAt(t[a>>2]>>a%4*8&15);return s}var D={data:function(){return{messageText:"",timestamp:"",isShowlargeTip:!1,inputErrorText:""}},updated:function(){this.scrollBottom()},mounted:function(){console.log(this.chatListData),this.scrollBottom()},methods:{getUserInfo:function(){var t=this,e=this.$route.query.id;""!=e.trim()?e!=localStorage.getItem("userid")?(this.$store.state.loading=!0,this.timestamp=(new Date).getTime(),this.$store.commit("WSsend",{data:{method:"getUserInfo",params:[e,this.timestamp]},callback:function(e){if(console.log(1111),e.serial&&200===e.code&&"getUserInfo"==e.method){if(e.serial!=t.timestamp)return;t.sendMessage(e.result[0].pub_key)}}})):this.$store.commit("showTopPopup",this.$t("message.chatlist7")):this.$store.commit("showTopPopup",this.$t("message.chatlist6"))},sendMessage:function(t){var e=this;try{if(""==this.messageText.trim())return void this.$store.commit("showTopPopup",this.$t("message.chatin3"));if(this.$getStrLeng(this.messageText)>384)return void this.$store.commit("showTopPopup",this.$t("message.chatin4"));var s=this.$route.query.id,a=nacl.randomBytes(nacl.secretbox.nonceLength),i=nacl.util.encodeBase64(a),o=localStorage.getItem("sec_key");console.log(t);var n=nacl.box(nacl.util.decodeUTF8(this.messageText),a,nacl.util.decodeBase64(t),nacl.util.decodeBase64(o)),r=localStorage.getItem("userid");this.timestamp=(new Date).getTime(),this.$store.commit("WSsend",{data:{method:"postMessage",params:[r,s,k(o),localStorage.getItem("pub_key"),1,nacl.util.encodeBase64(n),i,this.timestamp]},callback:function(a){if(200===a.code&&"postMessage"==a.method){if(!a.serial)return;if(a.serial!=e.timestamp)return;e.timestamp=(new Date).getTime();var i=new Date,o=i.getMinutes()<=9?"0"+i.getMinutes():i.getMinutes(),n=i.getSeconds()<=9?"0"+i.getSeconds():i.getSeconds(),r=(i.getHours()<=9?"0"+i.getHours():i.getHours())+":"+o+":"+n;e.$store.commit("addChatUser",{userid:s,list:[{message:e.messageText,self:!0,time:r}],pk:t}),e.messageText=""}}})}catch(t){this.$store.commit("showTopPopup",this.$t("message.chatin5"))}},scrollBottom:function(){this.$refs.main&&(this.$refs.main.scrollTop=this.$refs.main.scrollHeight)}},watch:{messageText:function(t,e){this.$getStrLeng(t)>384?this.inputErrorText=this.$t("message.chatin4"):this.inputErrorText="",this.$refs.main.style="padding-bottom:"+this.$refs.footer.offsetHeight+"px"}},computed:{chatListData:function(){return this.$store.state.chatUserList},changeM:function(){return this.$store.state.changeM}}},V={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-in-page"},[s("header",{staticClass:"header"},[s("a",{staticClass:"back-btn",attrs:{href:"javascript:;"},on:{click:function(e){t.$router.go(-1)}}}),t._v(" "),s("div",[s("p",[t._v(t._s(t.$route.query.id))]),t._v(" "),s("span",[t._v(t._s(t.$t("message.chatin1")))])])]),t._v(" "),s("div",{ref:"main",staticClass:"main"},[s("ul",{ref:"listWrap"},t._l(t.chatListData[t.$route.query.id].list,function(e){return s("li",{class:{self:e.self}},[s("i",{staticClass:"iconfont",attrs:{slot:"left"},slot:"left"},[t._v("")]),t._v(" "),s("p",[t._v(t._s(e.message))])])}))]),t._v(" "),s("footer",{ref:"footer"},[s("div",{staticClass:"input-wrap"},[s("mu-text-field",{attrs:{hintText:t.$t("message.chatin2"),errorText:t.inputErrorText,multiLine:"",rows:1,rowsMax:6},model:{value:t.messageText,callback:function(e){t.messageText=e},expression:"messageText"}}),t._v(" "),s("i",{staticClass:"iconfont",attrs:{slot:"left"},on:{click:t.getUserInfo},slot:"left"},[t._v("")])],1),t._v(" "),s("div",{staticStyle:{display:"none"}},[t._v(t._s(t.changeM))])])])},staticRenderFns:[]};var M=s("VU/8")(D,V,!1,function(t){s("Q8Vs")},"data-v-54d85250",null).exports,W=s("mvHQ"),z=s.n(W),B={data:function(){return{userid:"",isShowAlert:!1,rebuildAlert:!1,urlQuery:null,secretKey:""}},mounted:function(){this.urlQuery=this.$route.query,localStorage.removeItem("key_store"),localStorage.removeItem("pub_key"),localStorage.removeItem("sec_key"),localStorage.removeItem("userid"),localStorage.removeItem("CHATDATA"),this.$store.state.chatUserList=JSON.parse(localStorage.getItem("CHATDATA"))||{},this.$store.state.langValue=localStorage.getItem("LANGUAGE")||"zh-CN",this.$i18n.locale=localStorage.getItem("LANGUAGE")||"zh-CN"},methods:{login:function(){var t=this;this.urlQuery=this.$route.query,0!=this.urlQuery.userStatus?this.secretKey?this.$store.commit("WSsend",{data:{method:"login",params:[this.urlQuery.userId,k(this.secretKey)]},callback:function(e){3003!=e.code||"login"!=e.method?200==e.code&&"login"==e.method&&(localStorage.setItem("pub_key",e.result[0].pub_key),localStorage.setItem("userid",t.urlQuery.userId),sessionStorage.setItem("userid",t.urlQuery.userId),localStorage.setItem("sec_key",t.secretKey),localStorage.setItem("key_store",z()({userid:t.urlQuery.userId,sec_key:t.secretKey})),t.$router.replace("chatlist")):"zh-CN"==t.$store.state.langValue?t.$store.commit("showTopPopup",e.result.cn):t.$store.commit("showTopPopup",e.result.en)}}):this.isShowAlert=!0:this.$router.replace({path:"register",query:{userId:this.urlQuery.userId,userStatus:this.urlQuery.userStatus}})},handleChange:function(t){this.$store.state.langValue=t,this.$i18n.locale=t,sessionStorage.setItem("LANG",t),localStorage.setItem("LANGUAGE",t)},rebuild:function(){this.isShowAlert=!1,this.rebuildAlert=!0},auth:function(){var t=this;this.$route.query.authCode?this.$store.commit("WSsend",{data:{method:"auth",params:[this.$route.query.userId,this.$route.query.authCode]},callback:function(e){200==e.code&&"auth"==e.method&&t.login()}}):this.$store.commit("showAlert",this.$t("message.login6"))},saveKey:function(){""!=this.secretKey.trim()?this.login():this.$store.commit("showTopPopup",this.$t("message.login7"))},goBack:function(){try{window.app.closeWebView()}catch(t){window.history.go(-1)}}},computed:{safetyStatus:function(){return this.$store.state.safetyStatus}}},O={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-page"},[s("div",{staticClass:"main"},[s("h3",[t._v(t._s(t.$t("message.miliao")))]),t._v(" "),s("p",[t._v(t._s(t.$t("message.miliaoPhrase")))]),t._v(" "),s("div",{staticClass:"lang-switch"},[s("mu-dropDown-menu",{attrs:{value:t.$store.state.langValue},on:{change:t.handleChange}},[s("mu-menu-item",{attrs:{value:"zh-CN",title:t.$t("message.Chinese")}}),t._v(" "),s("mu-menu-item",{attrs:{value:"en-US",title:t.$t("message.English")}})],1)],1),t._v(" "),s("mu-dialog",{staticClass:"secretkey-input",attrs:{open:t.isShowAlert,title:t.$t("message.login1")}},[s("mu-text-field",{staticStyle:{width:"100%"},attrs:{hintText:t.$t("message.login2")},model:{value:t.secretKey,callback:function(e){t.secretKey=e},expression:"secretKey"}}),t._v(" "),s("p",{staticClass:"tip",staticStyle:{color:"#c33","font-size":"12px"}},[t._v(t._s(t.$t("message.login8")))]),t._v(" "),s("mu-flat-button",{attrs:{slot:"actions",primary:"",label:t.$t("message.login3")},on:{click:t.rebuild},slot:"actions"}),t._v(" "),s("mu-flat-button",{attrs:{slot:"actions",primary:"",label:t.$t("message.chatlist3")},on:{click:t.saveKey},slot:"actions"}),t._v(" "),s("a",{staticClass:"login-popup-close",attrs:{href:"javascript:;"},on:{click:function(e){t.isShowAlert=!1}}},[s("i",{staticClass:"iconfont"},[t._v("")])])],1),t._v(" "),s("mu-dialog",{attrs:{open:t.rebuildAlert,title:t.$t("message.login4")}},[t._v("\n                "+t._s(t.$t("message.login5"))+"\n                "),s("mu-flat-button",{attrs:{slot:"actions",primary:"",label:t.$t("message.chatlist4")},on:{click:function(e){t.rebuildAlert=!1}},slot:"actions"}),t._v(" "),s("mu-flat-button",{attrs:{slot:"actions",primary:"",label:t.$t("message.chatlist3")},on:{click:function(e){t.$router.replace({path:"register",query:{userId:t.urlQuery.userId,userStatus:t.urlQuery.userStatus}})}},slot:"actions"})],1),t._v(" "),s("div",{staticClass:"return-btn",on:{click:t.goBack}},[s("i",{staticClass:"iconfont"},[t._v("")])])],1),t._v(" "),s("footer",[s("mu-raised-button",{staticClass:"login-btn",attrs:{label:t.$t("message.login"),primary:""},nativeOn:{click:function(e){return t.auth(e)}}})],1)])},staticRenderFns:[]};var R=s("VU/8")(B,O,!1,function(t){s("hMum")},null,null).exports,K={data:function(){return{userid:"",loginUserid:"",toast:!1,timestamp:"",secretKey:"",isRegisterOk:!1}},mounted:function(){this.register()},computed:{registerUserid:function(){return this.$store.state.registerUserid}},methods:{copy:function(){var t=this,e=new u.a(".tag-read");e.on("success",function(s){t.$store.commit("showTopSuccess",t.$t("message.copySuccess")),e.destroy()}),e.on("error",function(s){t.$store.commit("showTopPopup",t.$t("message.tip01")),e.destroy()})},register:function(){var t=this,e=nacl.box.keyPair(),s=nacl.util.encodeBase64(e.publicKey),a=nacl.util.encodeBase64(e.secretKey),i=this.$route.query;this.$store.commit("WSsend",{data:{method:"register",params:[i.userId,s,k(a)]},callback:function(e){200==e.code&&"register"==e.method&&(sessionStorage.setItem("userid",i.userId),localStorage.setItem("userid",i.userId),localStorage.setItem("pub_key",s),localStorage.setItem("sec_key",a),t.secretKey=a,t.isRegisterOk=!0)}})},login:function(){var t=this;this.timestamp=(new Date).getTime(),this.$store.commit("WSsend",{data:{method:"login",params:[this.$route.query.userId,k(localStorage.getItem("sec_key"))]},callback:function(e){3003!=e.code||"login"!=e.method?200==e.code&&"login"==e.method&&t.$router.replace("chatlist"):"zh-CN"==t.$store.state.langValue?t.$store.commit("showTopPopup",e.result.cn):t.$store.commit("showTopPopup",e.result.en)}})}}},q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"register-page"},[s("div",{staticClass:"main"},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("message.register1")))]),t._v(" "),s("div",{staticClass:"textarea-wrap"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.secretKey,expression:"secretKey"}],attrs:{disabled:""},domProps:{value:t.secretKey},on:{input:function(e){e.target.composing||(t.secretKey=e.target.value)}}}),t._v(" "),s("mu-raised-button",{staticClass:"tag-read",attrs:{label:t.$t("message.copy"),"data-clipboard-text":t.secretKey},nativeOn:{click:function(e){return t.copy(e)}}})],1),t._v(" "),s("p",{staticClass:"tip"},[t._v(t._s(t.$t("message.register2"))+"："),s("br"),t._v(t._s(t.$t("message.register3")))]),t._v(" "),s("div",{staticClass:"login-container"},[s("mu-raised-button",{directives:[{name:"show",rawName:"v-show",value:t.isRegisterOk,expression:"isRegisterOk"}],staticClass:"login-btn",attrs:{label:t.$t("message.register6"),primary:""},nativeOn:{click:function(e){return t.login(e)}}})],1),t._v(" "),t.toast?s("mu-toast",{staticClass:"tipbox",attrs:{message:t.toastMessage}}):t._e()],1)])},staticRenderFns:[]};var F=s("VU/8")(K,q,!1,function(t){s("R62F")},"data-v-0adc4fc2",null).exports,H={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"specification-page"},[s("mu-appbar",{staticClass:"header",attrs:{title:"会员费用详情"}},[s("i",{staticClass:"iconfont",attrs:{slot:"left"},on:{click:function(e){t.$router.go(-1)}},slot:"left"},[t._v("")])]),t._v(" "),t._m(0)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"main"},[e("p",[this._v("\n            备注：您充值的sac，一部分是以太坊公网收取的，一部分是我们的运营开发费用。"),e("br"),e("br"),this._v("\n            这是密信第一个版本，使用的是以太坊的公链。由于以太坊需要收取一定的成本费用，同时我们的平台运营和开发人员也需要一定的成本费用，故向您收取sac。 后期我们将在eos上发行新的属于我们自己的公链，整个研发过程中我们将持续地竭诚为您的信息安全服务。\n        ")])])}]};var Q=s("VU/8")(null,H,!1,function(t){s("cnrw")},"data-v-11a96702",null).exports;a.default.use(n.a);var G=new n.a({routes:[{path:"/",name:"Index",component:c,redirect:"chatlist",meta:{isLogin:!0},children:[{path:"wallet",name:"wallet",component:d,meta:{isLogin:!0}},{path:"chatlist",name:"chatlist",component:f,meta:{isLogin:!0}},{path:"setting",name:"setting",component:y,meta:{isLogin:!0}},{path:"addchat",name:"addchat",component:b,meta:{isLogin:!0}}]},{path:"/chatin",component:M,meta:{isLogin:!0}},{path:"/login",component:R},{path:"/register",component:F},{path:"/specification",component:Q}]});G.beforeEach(function(t,e,s){t.meta.isLogin?localStorage.getItem("userid")?s(!0):s({path:"login"}):s(!0)});var j=G,Y=s("NYxO");a.default.use(Y.a);var J=new Y.a.Store({state:{ws:null,chatUserList:{},isShowTopPopup:!1,isShowSuccess:!1,isShowAlert:!1,alertText:"",tipText:"",userInfo:{userid:""},loading:!0,changeM:"",registerUserid:"",minute5logout:!1,timer:null,langValue:"zh-CN",safetyStatus:!1},mutations:{WSconnect:function(t,e){var s=this;if(!e)return console.error("websocket连接地址有误"),void("zh-CN"==t.langValue?this.commit("showTopPopup","服务器连接地址有误"):this.commit("showTopPopup","The server connection address is not correct"));"WebSocket"in window?(t.ws=new WebSocket(e),t.ws.onopen=function(){console.log("连接成功"),t.loading=!1,localStorage.getItem("userid")&&localStorage.getItem("sec_key")?(s.commit("WSsend",{data:{method:"login",params:[localStorage.getItem("userid"),k(localStorage.getItem("sec_key"))]}}),t.chatUserList=JSON.parse(localStorage.getItem("CHATDATA"))||{}):localStorage.removeItem("CHATDATA")},t.ws.onmessage=function(e){t.timer&&clearTimeout(t.timer),t.minute5logout&&(t.timer=setTimeout(function(){t.minute5logout=!1;var e=sessionStorage.getItem("userid");s.commit("WSsend",{data:{method:"logout",params:[e]}})},3e5)),t.loading=!1;var a,i,o,n,r,c,l,u,m=JSON.parse(e.data);if(console.log(m),200==m.code)switch(m.method){case"pushMessage":var h=function(e,s,a){try{var i=localStorage.getItem("sec_key"),o=nacl.box.open(nacl.util.decodeBase64(e),nacl.util.decodeBase64(s),nacl.util.decodeBase64(a),nacl.util.decodeBase64(i));return nacl.util.encodeUTF8(o)}catch(e){return"zh-CN"==t.langValue?"***您的密钥已更新，此消息无法解开***":"***Your key has been updated, and this message cannot be undone***"}}(m.result.msg_data,m.result.msg_nonce,m.result.msg_pubkey);if(!h)return;var d=(a=m.result.msg_time,i=new Date,(o=new Date(1e3*a)).getFullYear(),n=o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1,r=o.getDate(),c=o.getHours(),l=o.getMinutes()<=9?"0"+o.getMinutes():o.getMinutes(),u=o.getSeconds()<=9?"0"+o.getSeconds():o.getSeconds(),i.getDate()==r?c+":"+l+":"+u:n+"/"+r+" "+c+":"+l+":"+u);s.commit("addChatUser",{userid:m.result.from_user_id,list:[{message:h,self:!1,time:d,timestamp:m.result.msg_time}],pk:m.result.msg_pubkey});break;case"logout":localStorage.removeItem("key_store"),localStorage.removeItem("pub_key"),localStorage.removeItem("sec_key"),localStorage.removeItem("userid"),localStorage.removeItem("CHATDATA"),sessionStorage.removeItem("userid");try{window.app.closeWebView()}catch(t){j.replace("login")}break;case"register":t.registerUserid=m.result;break;case"login":localStorage.setItem("pub_key",m.result[0].pub_key),localStorage.setItem("userid",m.result[0].user_id),sessionStorage.setItem("userid",m.result[0].user_id),localStorage.setItem("key_store",z()({userid:m.result[0].user_id,sec_key:m.result[0].sec_key}));break;case"auth":t.safetyStatus=!0}else"zh-CN"==t.langValue?s.commit("showTopPopup",m.result.cn):s.commit("showTopPopup",m.result.en)},t.ws.onclose=function(){console.log("连接已关闭"),"zh-CN"==t.langValue?s.commit("showTopPopup","连接已关闭"):s.commit("showTopPopup","Connection closed"),t.loading=!0,s.commit("WSconnect",window.SERVER_PATH)}):alert("当前环境暂不支持聊天")},WSsend:function(t,e){switch(t.ws.readyState){case 0:setTimeout(function(){t.ws.send(z()(e.data)),e.callback&&t.ws.addEventListener("message",function s(a){var i=a;e.callback(JSON.parse(i.data)),t.ws.removeEventListener("message",s)})},1e3);break;case 1:if(t.ws.send(z()(e.data)),!e.callback)return;t.ws.addEventListener("message",function s(a){var i=a;e.callback(JSON.parse(i.data)),t.ws.removeEventListener("message",s)});break;case 2:"zh-CN"==t.langValue?this.commit("showTopPopup","连接尚未连接正在进行关闭建立"):this.commit("showTopPopup","Connection closed");break;case 3:"zh-CN"==t.langValue?this.commit("showTopPopup","连接已经关闭或者连接不能打开"):this.commit("showTopPopup","Connection closed")}},addChatUser:function(t,e){t.changeM=(new Date).getTime(),t.chatUserList.hasOwnProperty(e.userid)?(e.list.length>0&&t.chatUserList[e.userid].list.push(e.list[0]),t.chatUserList[e.userid].pk=e.pk):t.chatUserList[e.userid]=e,localStorage.setItem("CHATDATA",z()(t.chatUserList))},showTopPopup:function(t,e){t.tipText=e,t.isShowTopPopup=!0,setTimeout(function(){t.isShowTopPopup=!1},1500)},showTopSuccess:function(t,e){t.tipText=e,t.isShowSuccess=!0,setTimeout(function(){t.isShowSuccess=!1},1e3)},showAlert:function(t,e){t.alertText=e,t.isShowAlert=!0}}}),X=s("u64Q"),Z=s.n(X),tt=(s("E51W"),s("TXmL")),et=s("AQny"),st=s.n(et),at=s("z8sE"),it=s.n(at),ot=s("v5o6"),nt=s.n(ot);"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){nt.a.attach(document.body)},!1),a.default.use(Z.a),a.default.use(tt.a);var rt=new tt.a({locale:"zh-CN",messages:{"zh-CN":it.a,"en-US":st.a}});console.log(window.SERVER_PATH),J.commit("WSconnect",window.SERVER_PATH),a.default.prototype.$getStrLeng=function(t){for(var e=0,s=t.length,a=-1,i=0;i<s;i++)e+=(a=t.charCodeAt(i))>=0&&a<=128?1:3;return e},a.default.config.productionTip=!1,new a.default({el:"#app",router:j,store:J,i18n:rt,components:{App:o},template:"<App/>"})},Q8Vs:function(t,e){},R62F:function(t,e){},cnrw:function(t,e){},gwW5:function(t,e){},hCDX:function(t,e){},hMum:function(t,e){},"x2y+":function(t,e){},z8sE:function(t,e){t.exports={message:{Chinese:"中文",English:"English",login:"开启聊天",logout:"安全退出",miliao:"密信",miliaoPhrase:"一款基于区块链的顶级安全匿名聊天软件",loginInputTip:"请输入您的短信密码语句进行登录",registerText:"没有帐号？创建一个新的匿名帐号",safety:"安全",copy:"复制",copyaddress:"复制",copySuccess:"复制成功",Connectionclosed:"连接已关闭",login1:"请输入您的密钥",login2:"请输入",login3:"忘记密钥",login4:"提示",login5:"重新生成后将无法解密在此之前的信息，确定继续？",login6:"登录环境异常",login7:"您输入的密钥不能为空",login8:"请确保密钥正确，否则将导致发送失败！",my:"个人",chat:"聊天",set:"设置",wdye:"您的余额",wallet1:"把地址发给他人，他人即可通过密信发送相应的信息到您的地址",wallet2:"条",wallet3:"备注：您充值的sac，一部分是以太坊公网收取的，一部分是我们的运营费用。",wallet4:"限时免费",wallet5:"购买成功",register1:"您的密钥已经生成",register2:"重要提示",register3:"此密钥将用于加解密您的聊天信息。请务必保存您的密钥.如果丢失， 将无法找回！请不要泄露给第三方，否则您的信息可能被泄露，我们概不负责！",register6:"我已保存，去聊天!",chatlist1:"开启新的聊天",chatlist2:"请输入对方地址",chatlist3:"确定",chatlist4:"取消",chatlist5:"请输入",chatlist6:"对方地址不能为空",chatlist7:"无法向自己发送",chatlist8:"无",chatin1:"匿名用户",chatin2:"请输入您的消息",chatin3:"发送内容不能为空",chatin4:"字符长度超出限制",chatin5:"发送失败",dlzhbnwk:"登录账号不能为空",tip01:"该浏览器不支持自动复制",specification1:"您所有聊天内容，都是使用高密级算法加密并保存到区块链，不会存放在任何其他平台。",specification2:"保护好您的私人密钥，隐私就得到最强的保护。当代超级计算机也无法破解您的聊天内容。",specification3:"您可以使用区块链浏览器查询聊天的呼叫信息。",set1:"5分钟后，自动安全退出应用，下一次登录需要重新输入密钥。",set2:"语言",welcome:"Welcome"}}}},["NHnr"]);